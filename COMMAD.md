#FAST命令调试指南
# 目录

- [说明](#说明)
- [初始化电机](#初始化电机)
- [编码器方向](#编码器方向)
- [编码器配置](#编码器配置)
- [启动电机](#启动电机)
- [停止电机](#停止电机)
- [编码器模式](#编码器模式)
- [复位命令](#复位命令)
- [PID设置命令](#PID设置命令)
- [速度设置](#速度设置)
- [位置设置](#位置设置)
- [DQ轴电流设置](#DQ轴电流设置)
- [极对数设置](#极对数设置)
- [波形打印波形](#电机参数波形打印)
- [波形数据设置](#电机波形数据设置)
- [获取当前电机参数命令](#获取当前电机参数命令)
- [LED设置](#LED设置命令)
- [保存参数](#保存参数)
- [读取参数](#读取参数)
- [打印版本号](#版本查询命令)

## 说明

触发类命令回复 执行内容
设置类命令回复 设置参数值
查询类回复查询值
未定义命令回复 XXX Unknown

## 初始化电机

```
INIT
```

## 编码器方向

附带参数 1 个
参数范围 0 - 1

```
ENCODEDIR 0
```

默认正向不用配置。
如编码器角度反向在配置。

## 编码器配置

附带参数 1 个
参数范围 0 - 65535

```
ENCODECONFIG 10000
```

命令执行后将对齐编码器和电机零点
搜索电机Z相位置后返回
并自动执行START命令电机、设置编码器模式为ABZ
执行成功后返回 `Encoder cpr: 10000`

## 启动电机

启动电机输出

```
START
```

## 停止电机

停止电机输出

```
STOP
```

## 编码器模式

配置编码器模式
附带参数 1 个
参数范围 0 - 4

0. 开环
1. ABZ增量编码器
2. SPI绝对值编码器
3. 霍尔信号传感器
4. 无感观测器

```
MODE 0
```

## 复位命令

设备复位模式
附带参数 1 个(可选)
参数范围 0-1
不带参数复位重启、带参数1复位进入DFU模式

```
RESET
```

## PID设置命令

PID参数设置
附带参数 5 个 (后2个可选)
参数范围 0-9999

1. SPEEDPID 速度PID
2. SETPOSPID 位置PID
3. SETIDPID D轴电流PID
4. SETIQPID Q轴电流PID
5. SETWHEELPID 方向盘回中PID

```
参数顺序：
Kp : //比例系数
Ki  : //积分系数
Kd : //微分系数
Ramp: //最大变化值
Limit: //最大输出限制
```

```
SETPOSPID 0.1 0.0001 0.2 1 5
```

## 速度设置

加速到目标转速
附带参数 1 个
参数范围 0-99999
单位RPM

```
SETSPEED 100
```

## 位置设置

移动到目标位置
附带参数 1 个
参数范围 -99999-99999.0
参数单位 电角度

角度换算
弧度值 = 电角度 / 极对数
角度值 = (弧度值 / 3.14) * 180

```
SETPOS 25.4
```

## DQ轴电流设置

设置电机目标电流
一般情况下
D轴给0
Q轴给电流数值（可以根据KV值换算电机扭矩）
附带参数 1 个
参数范围 0-100.0A

```
SETID 0
SETIQ 3.5
```

## 电机极对数设置

设置电机极对数（电机极对数准确换算速度才准确）
默认 4 极对
附带参数 1 个
参数范围 0-99

```
SETPAIR 4
```

## 电机参数波形打印

开启或关闭参数波形打印数据输出

```
WAVE
```

## 电机波形数据设置

设置波形输出的数据

```
参数一:
	打印波形通道 
	参数范围 0 - 5
参数二:
	通道数据设置
	参数范围 0 - 12
	`[0:2]->ABC相电流`
	`[3:5]->D轴目标电流、实际电流、电压`
	`[6:8]->Q轴目标电流、实际电流、电压`
	`[9]->编码器角度`
	`[10]->目标位置`
	`[11]->供电电压`
	`[12]->目标速度`
```

```
SETDATA 0 0
```

## 打印电机当前数据

返回电机当前所有数据

```
DC:供电电压,A:电流A,B:电流B,C:电流C,D:D轴电流,Q:Q轴电流,POS:当前位置,SPEED:当前速度
```

```
DUMP
```

## LED设置命令

设置WS2812灯珠颜色、模式

参数 0 ：标志位
参数 1 ：红 （0-255）
参数 2 ：绿 （0-255）
参数 3 ：蓝 （0-255）
参数 4 ：灯珠数量

```
LED 0 255 255 255 20
```

## 保存参数

保存设置的所有参数到FLASH
返回参数保存位置 和 CRC校验值

```
SAVE
```

## 读取参数

读取最后一次保存的参数数据
参数可选 1 个
带参数（大于最后保存位置则读取最后一个保存数据）则读取指定位置的参数

```
READ 0
```

## 版本查询命令

```
VERSION
```
